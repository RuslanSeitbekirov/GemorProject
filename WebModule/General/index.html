<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</title>
    <link rel="stylesheet" href="GENstyle.css">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    <div class="topLine" id="header" style="display: none;">
        <div class="logo">
            –¢–µ—Å—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
            <span id="statusIndicator" class="status-indicator"></span>
        </div>
        <div class="Profile">
            <a href="javascript:void(0)" onclick="showProfile()">
                <img src="img/Prof.jpg" alt="–ü—Ä–æ—Ñ–∏–ª—å" id="Profile_img">
                <span id="username"></span>
            </a>
            <div class="header-actions">
                <button onclick="auth.handleLogout()" class="logout-btn">–í—ã–π—Ç–∏</button>
                <button onclick="auth.handleLogout(true)" class="logout-btn" title="–í—ã–π—Ç–∏ —Å–æ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤">
                    –í—ã–π—Ç–∏ –≤–µ–∑–¥–µ
                </button>
            </div>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="mainContent">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ -->
    </div>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="sessionStore.js"></script>
    <script src="auth.js"></script>
    <script src="testCreator.js"></script>
    
    <script>
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –ø—Ä–æ—Ñ–∏–ª—è
        function showProfile() {
            if (auth && auth.currentSession && auth.currentSession.userData) {
                const user = auth.currentSession.userData;
                let message = `üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n`;
                message += `–ò–º—è: ${user.name}\n`;
                message += `Email: ${user.email}\n`;
                message += `ID: ${user.id}\n`;
                message += `–ü—Ä–æ–≤–∞–π–¥–µ—Ä: ${user.provider}\n`;
                message += `–°—Ç–∞—Ç—É—Å: ${auth.currentSession.status}\n`;
                
                if (auth.currentSession.accessToken) {
                    message += `\n–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞: ${auth.currentSession.accessToken.substring(0, 20)}...`;
                }
                
                alert(message);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤ —à–∞–ø–∫–µ
        function updateStatusIndicator() {
            const indicator = document.getElementById('statusIndicator');
            if (indicator && auth && auth.currentSession) {
                indicator.className = `status-indicator status-${auth.currentSession.status}`;
                indicator.textContent = auth.currentSession.status === 'authorized' ? 
                    '–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' : '–ê–Ω–æ–Ω–∏–º–Ω—ã–π';
            }
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            if (auth && auth.currentSession) {
                updateStatusIndicator();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —à–∞–ø–∫—É –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
                if (auth.currentSession.status === 'authorized') {
                    document.getElementById('header').style.display = 'flex';
                }
            }
        });
    </script>
</body>
</html>