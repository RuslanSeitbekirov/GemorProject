{% extends "auth.html" %}
{% block Button_top_right %}
Sign up
{% endblock %}

{% block card_form %}
<div class="container">
    <div class="register-card">
        <h2 class="register_title">Log in</h2>
        <p>Choose authentication method:</p>

        <!-- Форма для ввода кода -->
        <div style="margin-top: 20px; padding: 20px; background-color: var(--hover-bg); border-radius: 10px;">
            <h3 style="margin-bottom: 15px; font-size: 1.2rem;">Enter Code</h3>
            <p style="margin-bottom: 15px; font-size: 0.9rem; color: var(--icon-color);">
                Get a 6-digit code from your mobile app and enter it below:
            </p>

            <form action="{{ url_for('login', type='code') }}" method="GET">
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <input type="text"
                           name="code"
                           class="input-field"
                           placeholder="123456"
                           maxlength="6"
                           pattern="\d{6}"
                           required
                           style="text-align: center; letter-spacing: 8px; font-size: 1.2rem; font-weight: bold;">
                </div>
                <button type="submit" class="register-btn" style="margin-top: 10px;">
                    Verify Code
                </button>
            </form>

            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--header-border);">
                <p style="font-size: 0.85rem; color: var(--icon-color); margin-bottom: 10px;">
                    Don't have a code?
                </p>
                <form action="{{ url_for('login', type='code') }}" method="GET">
                    <input type="hidden" name="get_code" value="true">
                    <button type="submit" class="login-btn" style="width: 100%; padding: 10px;">
                        Get New Code
                    </button>
                </form>
            </div>
        </div>

        <!-- Отображение сгенерированного кода (если запрошен) -->
        {% if code %}
        <div style="margin-top: 20px; padding: 15px; background: linear-gradient(90deg, #3b82f6, #22c55e); border-radius: 10px; color: white;">
            <h3 style="margin-bottom: 10px;">Your Code:</h3>
            <div style="font-size: 2rem; font-weight: bold; letter-spacing: 8px; text-align: center; margin: 15px 0;">
                {{ code }}
            </div>
            <p style="font-size: 0.85rem; opacity: 0.9;">
                This code will expire in 1 minute.<br>
                Enter it in your mobile app.
            </p>
        </div>
        {% endif %}

        {% if error %}
        <div style="margin-top: 15px; padding: 10px; background-color: #fee; border: 1px solid #f99; border-radius: 5px; color: #c00;">
            {{ error }}
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block card_insta_login %}
<div class="container">
    <div class="register-card">
        <h2 class="log_in_with_text">Log in with:</h2>
        <div class="log_in_with_flex">
            <div class="log_in_with_divs">
                <a href="{{ url_for('login', type='github') }}">
                    <img class="Log_in_with" src="https://cdn-icons-png.freepik.com/512/3291/3291695.png" alt="GitHub">
                </a>
            </div>
            <div class="log_in_with_divs">
                <a href="{{ url_for('login', type='yandex') }}">
                    <img class="Log_in_with" src="https://cdn-icons-png.freepik.com/512/6124/6124986.png" alt="Yandex">
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}